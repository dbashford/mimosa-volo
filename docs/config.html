<!DOCTYPE html>  <html> <head>   <title>config.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="config.html">                 config.js               </a>                                           <a class="source" href="index.html">                 index.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               config.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <h2>Module Configuration</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>The code contained herein is all example code and shouldn't be used verbatim.
The example in this case is modified from the mimosa-minify module.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="s2">&quot;use strict&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>The defaults function should return a JSON object containing the default
config for your module. If your module has no config, the function can be
removed or return null. Mimosa uses this function when applying default
configuration to a user's config.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">defaults</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">minify</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">exclude</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;\\.min\\.&quot;</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>The placeholder function should return a string that represents the
mimosa-config placeholder for your configuration defaults including
explanations for each config setting where appropriate.  The content
of the string should be all commented out. If you have no config,
the function can be removed or can return null.  This function is called
when Mimosa is creating an initial mimosa-config using 'mimosa new' or
'mimosa config'</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">placeholder</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s2">&quot;\t\n&quot;</span><span class="o">+</span>
         <span class="s2">&quot;  # minify:                    # Configuration for non-require minification/compression via uglify\n&quot;</span> <span class="o">+</span>
         <span class="s2">&quot;                               # using the --minify flag.\n&quot;</span> <span class="o">+</span>
         <span class="s2">&quot;    # exclude:[\&quot;\\\\.min\\\\.\&quot;]     # List of regexes to exclude files when running minification.\n&quot;</span> <span class="o">+</span>
         <span class="s2">&quot;                               # Any path with \&quot;.min.\&quot; in its name, like jquery.min.js, is assumed to\n&quot;</span> <span class="o">+</span>
         <span class="s2">&quot;                               # already be minified and is ignored by default. Override this property\n&quot;</span> <span class="o">+</span>
         <span class="s2">&quot;                               # if you have other files that you&#39;d like to exempt from minification.&quot;</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>The validate function should take a config object (which is the entire
mimosa-config), find the module specific config, validate the settings
and return a list of strings that are validation error messages. If
there are no errors, return an empty array or return nothing.  Mimosa
uses this function when Mimosa starts up to ensure the configuration
has been set properly.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">exports</span><span class="p">.</span><span class="nx">validate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">errors</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">minify</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">config</span><span class="p">.</span><span class="nx">minify</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">minify</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">minify</span><span class="p">.</span><span class="nx">exclude</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">minify</span><span class="p">.</span><span class="nx">exclude</span><span class="p">))</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">exls</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">minify</span><span class="p">.</span><span class="nx">exclude</span><span class="p">;</span>
          <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">_i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">_len</span> <span class="o">=</span> <span class="nx">exls</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">_i</span> <span class="o">&lt;</span> <span class="nx">_len</span><span class="p">;</span> <span class="nx">_i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">ex</span> <span class="o">=</span> <span class="nx">exls</span><span class="p">[</span><span class="nx">_i</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">ex</span> <span class="o">!==</span> <span class="s2">&quot;string&quot;</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">errors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;minify.exclude must be an array of strings&quot;</span><span class="p">);</span>
              <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">errors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;minify.exclude must be an array.&quot;</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">errors</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;minify configuration must be an object.&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>The validate function is also an opportunity to do configuration massaging,
for instance, turning a list of strings into a single RegExp.  Changes
made to the config inside validate are permament and carried throughout
the currently running Mimosa process.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nx">errors</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">config</span><span class="p">.</span><span class="nx">minify</span><span class="p">.</span><span class="nx">exclude</span> <span class="o">&amp;&amp;</span> <span class="nx">config</span><span class="p">.</span><span class="nx">minify</span><span class="p">.</span><span class="nx">exclude</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">config</span><span class="p">.</span><span class="nx">minify</span><span class="p">.</span><span class="nx">exclude</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">minify</span><span class="p">.</span><span class="nx">exclude</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">),</span> <span class="s2">&quot;i&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">errors</span><span class="p">;</span>
<span class="p">};</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 